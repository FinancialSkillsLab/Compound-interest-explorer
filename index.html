<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Watch Your Savings Grow</title>
<style>
  :root{
    /* TUSA-ish palette */
    --bg:#faf9f6; --ink:#292424; --accent:#004851; --muted:#91C0CB; --card:#ffffff;
    --pill:#f4f6f8;
  }
  *{box-sizing:border-box}
  body{margin:0;font:16px/1.5 system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;color:var(--ink);background:var(--bg)}
  .wrap{max-width:1200px;margin:40px auto;padding:24px}
  .card{background:var(--card);border-radius:16px;box-shadow:0 8px 24px rgba(0,0,0,.06);padding:24px}
  h1{margin:0 0 8px;color:var(--accent);font-size:2rem}
  h2{margin:0 0 12px;color:var(--accent);font-size:1.25rem}

  /* Intro */
  .intro{display:grid;gap:16px;justify-items:start;text-align:left}
  .lead{max-width:70ch}
  .cta{display:flex;gap:10px;flex-wrap:wrap}
  .btn{appearance:none;border:0;border-radius:12px;padding:12px 18px;font-weight:700;cursor:pointer}
  .btn-primary{background:var(--accent);color:#fff}
  .btn-ghost{background:#fff;border:1px solid #e6e6e6;color:var(--accent)}

  /* Simulator layout */
  .layout{display:grid;gap:24px;grid-template-columns:420px 1fr}
  @media (max-width: 960px){ .layout{grid-template-columns:1fr} }

  .grid{display:grid;gap:12px}
  label{font-weight:600;display:flex;flex-direction:column;gap:6px}
  input,select{padding:10px 12px;border:1px solid #ddd;border-radius:10px;font:inherit}
  .actions{margin-top:12px;display:flex;gap:8px;flex-wrap:wrap}
  .note{margin:10px 0 0;font-size:.9rem;color:#444}

  /* Results (right pane) */
  #results{display:block}
  .totals{display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:8px;margin:8px 0 16px}
  .pill{background:var(--pill);padding:10px 12px;border-radius:12px}
  .group{background:#fff;border:1px solid #eee;border-radius:12px;padding:16px}
  .legend{display:flex;gap:10px;align-items:center;margin:2px 0 10px}
  .swatch{width:12px;height:12px;border-radius:3px;display:inline-block;vertical-align:middle}
  .swatch-a{background:#1f6feb}
  .swatch-b{background:#2da44e}

  table{width:100%;border-collapse:collapse;margin-top:14px;background:#fff;border:1px solid #eee;border-radius:12px;overflow:hidden}
  th,td{padding:10px 12px;border-bottom:1px solid #eee;text-align:right;white-space:nowrap}
  th:first-child,td:first-child{text-align:left}
  tfoot td{font-weight:700}

  footer{margin-top:18px;font-size:.85rem;color:#666}
  .hide{display:none}
</style>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
<div class="wrap">

  <!-- INTRO VIEW -->
  <div id="intro" class="card intro">
    <h1>Watch Your Savings Grow</h1>
    <p class="lead">See how small weekly savings add up over time. Weekly deposits with monthly compounding. Compare two start ages to see the value of starting earlier.</p>
    <div class="cta">
      <button class="btn btn-primary" id="start">Start</button>
      <a class="btn btn-ghost" href="#sim">Read more→</a>
    </div>
  </div>

  <!-- SIMULATOR VIEW -->
  <div id="sim" class="card hide">
    <div class="layout">
      <!-- LEFT: Inputs -->
      <div>
        <h2>Inputs</h2>
        <div class="grid">
          <label>Weekly savings (A$)
            <input type="number" id="weekly" value="50" min="0" step="1">
          </label>
          <label>Annual interest rate (% p.a.)
            <input type="number" id="rate" value="7" min="0" step="0.1">
          </label>
          <label>Start age – Scenario A
            <input type="number" id="startA" value="20" min="0" step="1">
          </label>
          <label>Start age – Scenario B
            <input type="number" id="startB" value="30" min="0" step="1">
          </label>
          <label>Retirement age
            <input type="number" id="retire" value="65" min="1" step="1">
          </label>
        </div>
        <div class="actions">
          <button class="btn btn-primary" id="run">Run</button>
          <button class="btn" id="reset">Reset</button>
        </div>
        <p class="note">Assumes a constant rate, weekly contributions converted to monthly (52/12), monthly compounding.</p>
      </div>

      <!-- RIGHT: Results (totals → chart → table) -->
      <div id="results">
        <!-- totals, chart + table are injected here -->
      </div>
    </div>
    <footer>For education only. Figures are indicative; not financial advice.</footer>
  </div>
</div>

<script>
const $ = s => document.querySelector(s);
const currency = v => Number(v||0).toLocaleString('en-AU',{style:'currency',currency:'AUD'});

function simulate({weekly, rate, startAge, retireAge}){
  const months = Math.max(0, (retireAge - startAge) * 12);
  const rMonthly = rate/100/12;
  const monthlyDeposit = weekly * 52/12; // weekly → monthly
  let bal = 0, yearly = [];
  for(let m=1; m<=months; m++){
    bal = (bal + monthlyDeposit) * (1 + rMonthly);
    if(m % 12 === 0){
      const age = startAge + (m/12);
      yearly.push({ age, balance: bal });
    }
  }
  return { final: bal, yearly };
}

function buildTable(rowsA, rowsB, minAge, maxAge){
  let html = `
    <table>
      <thead>
        <tr><th>Age</th><th>A: start ${minAge} balance</th><th>B: start ${Math.min(...rowsB.map(r=>r.age)) || '-'} balance</th></tr>
      </thead>
      <tbody>
  `;
  // Build a map for quick lookup
  const mapA = new Map(rowsA.map(r=>[Math.round(r.age), r.balance]));
  const mapB = new Map(rowsB.map(r=>[Math.round(r.age), r.balance]));
  for(let age=Math.floor(minAge); age<=Math.floor(maxAge); age++){
    const a = mapA.get(age) ?? 0;
    const b = mapB.get(age) ?? 0;
    html += `<tr><td>${age}</td><td>${a?currency(a):'—'}</td><td>${b?currency(b):'—'}</td></tr>`;
  }
  html += `</tbody></table>`;
  return html;
}

let chart;

function render(){
  const weekly = +$('#weekly').value||0;
  const rate   = +$('#rate').value||0;
  const startA = +$('#startA').value||0;
  const startB = +$('#startB').value||0;
  const retire = +$('#retire').value||0;

  const simA = simulate({weekly, rate, startAge: startA, retireAge: retire});
  const simB = simulate({weekly, rate, startAge: startB, retireAge: retire});

  const minStart = Math.min(startA, startB);
  const labels = [];
  const dataA = [];
  const dataB = [];
  const endAge = retire;

  // Build yearly series aligned from minStart → retire
  const mapA = new Map(simA.yearly.map(r=>[Math.round(r.age), r.balance]));
  const mapB = new Map(simB.yearly.map(r=>[Math.round(r.age), r.balance]));
  for(let age=Math.floor(minStart); age<=Math.floor(endAge); age++){
    labels.push(age);
    dataA.push(mapA.get(age) || null);
    dataB.push(mapB.get(age) || null);
  }

  const diff = simA.final - simB.final;

  // Results HTML (totals → chart → table)
  $('#results').innerHTML = `
    <h2>Growth Over Time</h2>
    <div class="totals">
      <div class="pill"><strong>A: start age ${startA} — Final:</strong> ${currency(simA.final)}</div>
      <div class="pill"><strong>B: start age ${startB} — Final:</strong> ${currency(simB.final)}</div>
      <div class="pill"><strong>Value of starting earlier:</strong> ${currency(diff)}</div>
    </div>

    <div class="group">
      <div class="legend">
        <span class="swatch swatch-a"></span> A: start age ${startA}
        <span style="width:12px;display:inline-block"></span>
        <span class="swatch swatch-b"></span> B: start age ${startB}
      </div>
      <canvas id="chart" height="220" aria-label="Balance over time"></canvas>

      ${buildTable(simA.yearly, simB.yearly, minStart, endAge)}
    </div>
  `;

  const ctx = document.getElementById('chart').getContext('2d');
  if(chart) chart.destroy();
  chart = new Chart(ctx, {
    type:'line',
    data:{
      labels,
      datasets:[
        {label:`A: start age ${startA}`, data:dataA, borderColor:'#1f6feb', backgroundColor:'transparent', tension:.25, spanGaps:true},
        {label:`B: start age ${startB}`, data:dataB, borderColor:'#2da44e', backgroundColor:'transparent', tension:.25, spanGaps:true}
      ]
    },
    options:{
      plugins:{legend:{display:false}},
      scales:{
        x:{title:{display:true,text:'Age'}},
        y:{title:{display:true,text:'Balance (A$)'}, ticks:{callback:v=>currency(v)}}
      }
    }
  });
}

/* Intro → Simulator */
$('#start').addEventListener('click', ()=>{
  $('#intro').classList.add('hide');
  $('#sim').classList.remove('hide');
  render();
});

/* Buttons */
$('#run').addEventListener('click', render);
$('#reset').addEventListener('click', ()=>{
  $('#weekly').value=50; $('#rate').value=7; $('#startA').value=20; $('#startB').value=30; $('#retire').value=65;
  render();
});

/* Load intro first */
window.addEventListener('DOMContentLoaded', ()=>{ /* stay on intro until Start */ });
</script>
</body>
</html>
